<Window x:Class="PL.MainVolunteer"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:PL"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        mc:Ignorable="d"
        Title="MainVolunteer" Height="640" Width="900"  
        Loaded="volunteerWindow_Loaded"
        Closed="volunteerWindow_Closed"
        WindowStartupLocation="CenterScreen"
    DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*" />

        </Grid.ColumnDefinitions>

        <ScrollViewer Grid.Column="0">
            <StackPanel Margin="20">

                <Label Content="ID"/>
                <TextBox Text="{Binding CurrentVolunteer.Id}" IsEnabled="False" />
                
                <Label Content="Full Name"/>
                <TextBox Text="{Binding CurrentVolunteer.FullName}" />

                <Label Content="Cellphone Number"/>
                <TextBox Text="{Binding CurrentVolunteer.CellphoneNumber}" />

                <Label Content="Email"/>
                <TextBox Text="{Binding CurrentVolunteer.Email}" />

                <!--<Label Content="Password"/>
                <TextBox Text="{Binding CurrentVolunteer.Password}" />-->

                <Label Content="Full Address"/>
                <TextBox Text="{Binding CurrentVolunteer.FullAddress}" />

                <Label Content="Max Distance"/>
                <TextBox Text="{Binding CurrentVolunteer.MaxDistance}" />

                <Label Content="Distance Type"/>
                <ComboBox SelectedValue="{Binding CurrentVolunteer.DistanceType}" 
                       ItemsSource="{Binding Source={StaticResource DistanceTypeCollectionKey}}" />

                <Label Content="Is Active"/>
                <CheckBox IsChecked="{Binding CurrentVolunteer.IsActive}" 
                       IsEnabled="{Binding CurrentVolunteer.CallInProgress, Converter={StaticResource NullToTrueConverter}}" />
                <Label Content="Role"/>
                <TextBox Text="{Binding CurrentVolunteer.Role}" IsEnabled="False" />

                <GroupBox Header="Assignments" VerticalAlignment="Bottom"  Margin="0,10,0,10"  Grid.Column="0"   Visibility="{Binding CurrentCall, Converter={StaticResource NullToVisibilityConverter}}" >
                    <DataGrid ItemsSource="{Binding CurrentCall.AssignmentsList}" AutoGenerateColumns="False" IsEnabled="False">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Volunteer ID" Binding="{Binding VolunteerId}" Width="*"/>
                            <DataGridTextColumn Header="Volunteer" Binding="{Binding VolunteerFullName}" Width="*"/>
                            <DataGridTextColumn Header="Assigned Time" Binding="{Binding StartTime}" Width="*"/>
                            <DataGridTextColumn Header="End Time" Binding="{Binding EndTime}" Width="*"/>
                            <DataGridTextColumn Header="End Type" Binding="{Binding EndType}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </GroupBox>
                
                <Button Content="Update" 
                     Click="btnAddUpdate_Click" 
                     Height="58" Width="180" FontWeight="Bold" />
            </StackPanel>
        </ScrollViewer>
        
        <StackPanel Grid.Column="1" Margin="20" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
            <GroupBox Header="Current Call" Margin="0 0 0 10" Height="200"
          Visibility="{Binding CurrentCall, Converter={StaticResource NullToVisibilityConverter}}">
                <StackPanel>
                    <TextBlock Text="{Binding CurrentCall.Description}" TextWrapping="Wrap" Margin="0,0,0,5" FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding CurrentCall.CallType, StringFormat='Call Type: {0}'}" Margin="0,0,0,2"/>
                    <TextBlock Text="{Binding CurrentCall.FullAddress, StringFormat='Address: {0}'}" Margin="0,0,0,2"/>
                    <TextBlock Text="{Binding CurrentCall.OpeningTime, StringFormat='Opening Time: {0:dd/MM/yyyy HH:mm}'}" Margin="0,0,0,2"/>
                    <TextBlock Text="{Binding CurrentCall.MaxFinishTime, StringFormat='Max Finish Time: {0:dd/MM/yyyy HH:mm}'}" Margin="0,0,0,2"/>
                    <TextBlock Text="{Binding CurrentCall.CallStatus, StringFormat='Status: {0}'}" FontWeight="Bold" Margin="0,0,0,5"/>
                </StackPanel>
            </GroupBox>
            <StackPanel Orientation="Horizontal" Margin="0 10" Height="38" Width="272">
                <Button Content="End Call Handling" Width="129"
            Click="btnEndCall_Click"
            Visibility="{Binding CurrentCall, Converter={StaticResource NullToVisibilityConverter}}"/>
                <Button Content="Cancel Call Handling" Width="145"
            Click="btnCancelCall_Click"
            Visibility="{Binding CurrentCall, Converter={StaticResource NullToVisibilityConverter}}"/>
            </StackPanel>
            <StackPanel Orientation="Vertical" Height="96">
                <Button Content="View Closed Calls" Click="btnHistory_Click" Width="180" Margin="5"/>
                <Button Content="Choose a Call" Click="btnChooseCall_Click" Width="180" Margin="5" 
                                Visibility="{Binding CurrentCall, Converter={StaticResource NullToCollapsedConverter}}" />
                <Button Content="Exit" Click="btnExit_Click" Width="180" Margin="5"/>
            </StackPanel>

            <wv2:WebView2 Name="webView" Height="228" 
                            Visibility="{Binding CurrentCall, Converter={StaticResource NullToVisibilityConverter}}"/>
        </StackPanel>

    </Grid>

</Window>

